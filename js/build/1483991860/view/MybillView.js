define(["app","view/cards/user_payments","view/modals/ModalTransferView","model/bills/MyBillModel","text!templates/bills/mybill.html","text!templates/headers/header-tertiary-model.html"],function(t,e,s,i,n,a){return Backbone.View.extend({className:"panel bill-view scroll-y",events:{"click .action-pay":"showTransferModal"},template:_.template(n),template_container:_.template(a),initialize:function(t){_.extend(this,t);var e=this;this.model=new i({_id:this._id}),this.model.fetch().then(function(){e.render()})},attachEvents:function(){this.on("transferAdded",this.initialize,this),this.listening=!0},render:function(){var s=this;this.listening||this.attachEvents();var i=this.model.toJSON(),n=t.router.getPath().split("/");n.pop(),this.$el.html(this.template({user:t.session.user.toJSON(),bill:i,back_path:n.join("/"),prettyMoney:t.utils.prettyMoney})),t.controls.maskMoney(".amount",this,7);var a=t.session.user.id;this.tenants=this.model.get("tenants"),this.tenants=this.tenants.sort(function(t,e){return t._id===a?-1:e._id===a?1:void 0});var l=this.model.get("transfers_by_user");return _.each(this.tenants,function(t){var i=t._id,n=new e({data:t,amount:l[i]});s.$el.find(".transfer-cards").append(n.$el)}),$(".tertiary").removeClass("loading"),this},hideTertiary:function(){$(".row.selected").removeClass("selected"),$("body").addClass("tertiary-hidden")},showTransferModal:function(){var e;if("monthly"===this.model.get("type")){var i,n=this.model.get("lease.split"),a=t.session.user.id;n&&(i=n[a]),e=i}else e=this.model.get("total");this.modal=new s({action:"submit",model:this.model,eventName:"transferAdded",context:this,amount:e})}})});
//# sourceMappingURL=MybillView.js.map
