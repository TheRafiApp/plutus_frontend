{"version":3,"sources":["view/account/activate/show_lease.js"],"names":["define","app","Template","Backbone","View","extend","className","template","_","events","click .action-next","initialize","options","this","render","console","log","step","user","parentView","toJSON","lease","roommates","tenants","filter","tenant","_id","map","first_name","last_name","length","has_first","charges","scheduled","some","charge","type","has_last","fees","push","$el","html","logo","templates","prettyMoney","utils","nextStep","next"],"mappings":"AAIAA,QACE,MACA,mDAEF,SAASC,EAAKC,GAEZ,MAAOC,UAASC,KAAKC,QAEnBC,UAAW,aACXC,SAAUC,EAAED,SAASL,GAErBO,QACEC,qBAAsB,YAGxBC,WAAY,SAASC,GACfA,GAASJ,EAAEH,OAAOQ,KAAMD,GAC5BC,KAAKC,UAGPA,OAAQ,WAGNC,QAAQC,IAAIH,KAAKI,KAEjB,IAAIC,GAAOL,KAAKM,WAAWD,KAAKE,SAC5BC,EAAQR,KAAKI,KAAKI,MAElBC,EAAYD,EAAME,QAAQC,OAAO,SAASC,GAC5C,GAAIA,EAAOC,MAAQR,EAAKQ,IACxB,OAAO,IACNC,IAAI,SAASF,GACd,MAAOA,GAAOG,WAAa,IAAMH,EAAOI,WAGjB,KAArBP,EAAUQ,SAAcR,GAAY,EAExC,IAAIS,GAAYV,EAAMW,QAAQC,UAAUC,KAAK,SAASC,GACpD,MAAuB,gBAAhBA,EAAOC,OAGZC,EAAWhB,EAAMW,QAAQC,UAAUC,KAAK,SAASC,GACnD,MAAuB,eAAhBA,EAAOC,OAGZE,IAmBJ,OAjBIP,IAAWO,EAAKC,KAAK,eACrBF,GAAUC,EAAKC,KAAK,cAEJ,IAAhBD,EAAKR,QAAcQ,EAAKC,KAAK,QAEjC1B,KAAK2B,IAAIC,KAAK5B,KAAKN,UACjBmC,KAAMzC,EAAI0C,UAAUD,OACpBrB,MAAOA,EACPiB,KAAMA,EACNhB,UAAWA,EACXsB,YAAa3C,EAAI4C,MAAMD,eAOlB/B,MAGTiC,SAAU,WACRjC,KAAKM,WAAW4B","file":"show_lease.js","sourcesContent":["/**\n * account/activate/show_lease.js\n */\n\ndefine([\n  'app',\n  'text!templates/account/activate/show_lease.html',\n],\nfunction(app, Template) {\n\n  return Backbone.View.extend({\n\n    className: 'show_lease',\n    template: _.template(Template),\n\n    events: {\n      'click .action-next': 'nextStep'\n    },\n\n    initialize: function(options) {\n      if (options) _.extend(this, options);\n      this.render();\n    },\n\n    render: function() {\n      var self = this;\n\n      console.log(this.step)\n\n      var user = this.parentView.user.toJSON();\n      var lease = this.step.lease;\n      \n      var roommates = lease.tenants.filter(function(tenant) {\n        if (tenant._id === user._id) return;\n        return true;\n      }).map(function(tenant) {\n        return tenant.first_name + ' ' + tenant.last_name;\n      });\n\n      if (roommates.length === 0) roommates = false;\n\n      var has_first = lease.charges.scheduled.some(function(charge) {\n        return charge.type === 'first_month';\n      });\n\n      var has_last = lease.charges.scheduled.some(function(charge) {\n        return charge.type === 'last_month';\n      });\n\n      var fees = [];\n\n      if (has_first) fees.push('First Month');\n      if (has_last) fees.push('Last Month');\n\n      if (fees.length === 0) fees.push('None');\n\n      this.$el.html(this.template({\n        logo: app.templates.logo(),\n        lease: lease,\n        fees: fees,\n        roommates: roommates,\n        prettyMoney: app.utils.prettyMoney\n      }));\n\n      // setTimeout(function() {\n      //   self.$el.addClass('active');\n      // }, 700);\n\n      return this;\n    },\n\n    nextStep: function() {\n      this.parentView.next();\n    }\n\n  });\n});"]}