define(["app"],function(e){var t=e.Model.extend({name:"user",displayName:"full_name",initialize:function(e,t){t||(t={}),this.options||(this.options={}),this.options=_.extend(this.options,t),this.options.role||(this.options.role="users"),this.on("change:phone_pretty",this.updatePhone,this)},urlRoot:function(){return e.API()+this.options.role+"/"},defaults:{first_name:"",last_name:""},schema:{phone:{type:"phone"},charges:[{amount:{type:"money"},phone:{type:"phone"}}]},filters:["full_name","role","profile","phone_pretty","initials","status","created","updated","intials"],full_name:Backbone.computed("first_name","last_name",function(){return this.isNew()?"":_.escape(this.get("first_name")+" "+this.get("last_name")||"")}),initials:Backbone.computed("first_name","last_name",function(){return this.isNew()?"":_.escape(this.get("first_name")[0]+""+this.get("last_name")[0]).toUpperCase()}),profile:Backbone.computed("_id","role",function(){var e=this.get("role");if(e)return"/"+e+"s/"+this.get("_id")}),phone_pretty:Backbone.computed("phone",function(){var t=this.get("phone");if(t)return e.utils.prettyPhone(t)}),dwolla_account:Backbone.computed("role","dwolla","company",function(){var e=this.get("role");if(["admin","tenant"].contains(e)){var t="";return"admin"===e&&(t="company."),t+="dwolla",this.get(t)}}),updatePhone:function(){var t=e.utils.uglyPhone(this.get("phone_pretty"));this.set("phone",t)},validation:{first_name:{required:!0,maxLength:60},last_name:{required:!0,maxLength:60},email:function(t,n,i){return t?t&&!e.utils.validateContact(t)?"Please enter a valid email address":void 0:"Email is required"},phone:function(t,n,i){if(t&&!e.utils.validateContact(t))return"Please enter a valid phone number"}},resendInvitation:function(t,n){t||(t={});var i=this.get("role")+"s/"+this.id+"/reinvite",r=$.Deferred();return e.utils.request({data:t,path:i}).success(function(e){return r.resolve(e)}).error(function(e){return r.reject(e)}),r},unremove:function(t,n){t||(t={});var i=this.get("role")+"s/"+this.id+"/unremove",r=$.Deferred();return e.utils.request({data:t,path:i,method:"PUT"}).success(function(e){return r.resolve(e)}).error(function(e){return r.reject(e)}),r}});return t});
//# sourceMappingURL=UserModel.js.map
