{"version":3,"sources":["view/FundingSourcesView.js"],"names":["define","app","FundingSourceView","FundingSourcesCollection","FundingSourcesTemplate","Backbone","View","extend","className","template","_","initialize","options","this","self","collection","bind","fetch","then","render","fail","error","controls","handleError","sortByField","$el","html","primary_fs","session","user","get","each","funding_source","primary","id","fs_view","model","parentView","find","append","removeClass"],"mappings":"AAIAA,QACE,MACA,yBACA,8CACA,uDAEF,SAASC,EAAKC,EAAmBC,EAA0BC,GAEzD,MAAOC,UAASC,KAAKC,QAEnBC,UAAW,+BAEXC,SAAUC,EAAED,SAASL,GAErBO,WAAY,SAASC,GAEnBF,EAAEH,OAAOM,KAAMD,EAEf,IAAIE,GAAOD,IAEXA,MAAKE,WAAa,GAAIZ,GAEtBU,KAAKE,WAAWC,KAAK,SAAUH,KAAKF,WAAYE,MAEhDA,KAAKE,WAAWE,QAAQC,KAAK,WAC3BJ,EAAKK,WACJC,KAAK,SAASC,GACfpB,EAAIqB,SAASC,YAAYF,GACzBP,EAAKK,YAITA,OAAQ,WACN,GAAIL,GAAOD,IAEXA,MAAKE,WAAWS,YAAY,QAE5BX,KAAKY,IAAIC,KAAKb,KAAKJ,WAEnB,IAAIkB,GAAa1B,EAAI2B,QAAQC,KAAKC,IAAI,wCAuBtC,OArBAjB,MAAKE,WAAWgB,KAAK,SAASC,GAG5B,GAAkC,WAA9BA,EAAeF,IAAI,QAAvB,CAGA,GAAIG,IAAU,CAEVD,GAAeE,IAAMP,IAAYM,GAAU,EAE/C,IAAIE,GAAU,GAAIjC,IAChBkC,MAAOJ,EACPK,WAAYvB,EACZmB,QAASA,GAGXnB,GAAKW,IAAIa,KAAK,oBAAoBC,OAAOJ,EAAQV,QAInDZ,KAAKY,IAAIe,YAAY,WACd3B,KAAKY","file":"FundingSourcesView.js","sourcesContent":["/**\n * FundingSourcesView.js\n */\n\ndefine([\n  'app',\n  'view/FundingSourceView',\n  'collection/account/FundingSourcesCollection',\n  'text!templates/funding_sources/funding_sources.html'\n],\nfunction(app, FundingSourceView, FundingSourcesCollection, FundingSourcesTemplate) {\n\n  return Backbone.View.extend({\n\n    className: 'form-model container loading',\n\n    template: _.template(FundingSourcesTemplate),\n\n    initialize: function(options) {\n\n      _.extend(this, options);\n\n      var self = this;\n\n      this.collection = new FundingSourcesCollection();\n\n      this.collection.bind('change', this.initialize, this);\n\n      this.collection.fetch().then(function() {\n        self.render();\n      }).fail(function(error) {\n        app.controls.handleError(error);\n        self.render();\n      });\n    },\n\n    render: function() {\n      var self = this;\n\n      this.collection.sortByField('name');\n\n      this.$el.html(this.template());\n\n      var primary_fs = app.session.user.get('dwolla_account.primary_funding_source');\n\n      this.collection.each(function(funding_source) {\n\n        // manually remove balance and removed from collection\n        if (funding_source.get('type') == 'balance') return;\n\n        // check if this is the primary fs\n        var primary = false;\n        // console.log(funding_source.id, primary_fs)\n        if (funding_source.id == primary_fs) primary = true;\n\n        var fs_view = new FundingSourceView({ \n          model: funding_source,\n          parentView: self,\n          primary: primary\n        });\n\n        self.$el.find('.funding-sources').append(fs_view.$el);\n\n      });\n\n      this.$el.removeClass('loading');\n      return this.$el;\n    }\n    \n  });\n});"]}