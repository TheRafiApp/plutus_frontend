define(["app","view/modals/ModalView","text!templates/modals/modal-invite.html"],function(e,t,o){return t.extend({title:function(){return this.action+" "+this.role},template:_.template(o),messages:{success:"The user was successfully invited",error:"The user could not be invited"},initialize:function(t){t&&_.extend(this,t);var o=this;this.role=e.utils.capitalize(this.context.modelName);var r="superadmin"===this.role?"":"invite";e.utils.loadModel.get("users/"+this.role+"Model").then(function(t){o.model=new t(null,{action:r}),e.controls.smartRender(o).then(function(){o.renderModalView()})})},render:function(){var t=e.collections.companies&&e.collections.companies.toJSON();return this.ready({companies:t}),this},handleError:function(t){var o,r,n=this,i=t.responseJSON;if("pymongo_duplicate_key_error"===i.error){if(o="There is already a user with that ","phone"===i.data.index_name?(r="phone",o+="phone number."):"email"===i.data.index_name&&(r="email",o+="email address."),console.log(r),i.data.removed)return void(confirm("This user was previously removed, would you like to un-remove them?")&&(console.log(r,i.data.removed._id),n.model.set(i.data.removed),n.model.unremove().then(function(){n.context.trigger(n.eventName),n.closeModal()}).fail(function(t){e.alerts.error("Sorry, we were unable to unremove that user."),console.warn(t)})))}else o="Sorry, unable to create user at this time.";console.warn(o),e.alerts.error(o)}})});
//# sourceMappingURL=ModalInviteView.js.map
