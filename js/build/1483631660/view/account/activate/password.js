define(["app","text!templates/account/activate/password.html"],function(e,t){return Backbone.View.extend({className:"password",template:_.template(t),events:{"click .action-next":"validate"},initialize:function(e){e&&_.extend(this,e),this.render()},render:function(){return console.log(this.step),this.$el.html(this.template({logo:e.templates.logo()})),e.controls.renderPasswordFields(this),this},validate:function(){var t=this.$el.find(".password"),s=this.$el.find(".password-confirm"),r=!1;return t.val()||(e.controls.fieldError({element:t,error:"Password is required"}),r=!0),!r&&(Backbone.Validation.patterns.password.test(t.val())||(e.controls.fieldError({element:t,error:Backbone.Validation.messages.password}),r=!0),s.val()!==t.val()&&(e.controls.fieldError({element:s,error:"Passwords must match"}),r=!0),s.val()||(e.controls.fieldError({element:s,error:"Please confirm your password"}),r=!0),!r&&void this.confirm(t.val()))},confirm:function(t){var s=this,r=this.parentView.user,o=r.email||r.phone,n={password:t};e.session.setPassword(n).then(function(){e.utils.stash.setItem("last-login",o),e.utils.stash.setItem("last-pw",t),s.parentView.next()}).fail(function(e){console.warn(e)})}})});
//# sourceMappingURL=password.js.map
