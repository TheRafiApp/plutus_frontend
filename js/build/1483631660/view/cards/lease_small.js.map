{"version":3,"sources":["view/cards/lease_small.js"],"names":["define","app","LeaseModel","LeaseCardTemplate","Backbone","View","extend","events","click","template","_","initialize","options","this","model","data","render","on","deleteModel","state","start_date","get","end_date","today","moment","utc","$el","html","lease","toJSON","tenants","prettyMoney","utils","viewLease","e","id","path","router","getPath","navigate","trigger"],"mappings":"AAIAA,QACE,MACA,0BACA,yCAEF,SAASC,EAAKC,EAAYC,GAExB,MAAOC,UAASC,KAAKC,QAEnBC,QACEC,MAAS,aAGXC,SAAUC,EAAED,SAASN,GAErBQ,WAAY,SAASC,GACnBF,EAAEJ,OAAOO,KAAMD,GAEfC,KAAKC,MAAQ,GAAIZ,GAAWW,KAAKE,MACjCF,KAAKG,UAGPA,OAAQ,WACNH,KAAKI,GAAG,gBAAiBJ,KAAKK,YAAaL,KAE3C,IAAIM,GAAQ,OACRC,EAAaP,KAAKC,MAAMO,IAAI,gBAC5BC,EAAWT,KAAKC,MAAMO,IAAI,cAC1BE,EAAQC,OAAOC,KAenB,OAbIL,GAAaG,GAASA,EAAQD,EAChCH,EAAQ,SACCC,EAAaG,IACtBJ,EAAQ,UAGVN,KAAKa,IAAIC,KAAKd,KAAKJ,UACjBmB,MAAOf,KAAKC,MAAMe,SAClBV,MAAOA,EACPW,QAASjB,KAAKiB,QACdC,YAAa9B,EAAI+B,MAAMD,eAGlBlB,MAGToB,UAAW,SAASC,GAClB,GAAIC,GAAKtB,KAAKC,MAAMO,IAAI,OACpBe,EAAOnC,EAAIoC,OAAOC,SACtBrC,GAAIoC,OAAOE,SAASH,EAAO,IAAMD,GAAMK,SAAS","file":"lease_small.js","sourcesContent":["/**\n * cards/lease.js\n */\n\ndefine([\n  'app',\n  'model/leases/LeaseModel',\n  'text!templates/cards/lease_small.html',\n],\nfunction(app, LeaseModel, LeaseCardTemplate) {\n\n  return Backbone.View.extend({\n\n    events: {\n      'click': 'viewLease'\n    },\n\n    template: _.template(LeaseCardTemplate),\n\n    initialize: function(options) {\n      _.extend(this, options);\n\n      this.model = new LeaseModel(this.data);\n      this.render();\n    },\n\n    render: function() {\n      this.on('confirmDelete', this.deleteModel, this);\n\n      var state = 'past';\n      var start_date = this.model.get('start_moment');\n      var end_date = this.model.get('end_moment');\n      var today = moment.utc();\n\n      if (start_date < today && today < end_date) {\n        state = 'active';\n      } else if (start_date > today) {\n        state = 'future';\n      }\n\n      this.$el.html(this.template({ \n        lease: this.model.toJSON(),\n        state: state,\n        tenants: this.tenants,\n        prettyMoney: app.utils.prettyMoney\n      }));\n      \n      return this;\n    },\n\n    viewLease: function(e) {\n      var id = this.model.get('_id');\n      var path = app.router.getPath();\n      app.router.navigate(path + '/' + id, { trigger: true });\n      \n    }\n\n  });\n});"]}