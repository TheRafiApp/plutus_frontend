define(["app","model/admin/debug/TestModel","text!templates/debug/menu.html"],function(t,e,n){return Backbone.View.extend({className:"debug-menu",template:_.template(n),events:{"click .action-debug-toggle":"toggleMenu","click .action-console-app":"consoleApp","click .action-console-session":"consoleSession","click .action-console-user":"consoleUser","click .action-console-stash":"consoleStash","click .action-require-modules":"consoleRequire","click .action-switch-api":"switchAPI","click .action-global-app":"globalApp","click .action-unit-tests":"unitTests","click .action-clear-stash":"clearStash","click .action-view-stash":"viewStash","click .action-skip-iav":"skipIAV","click .action-error":"sendError","click .action-alert":"alertError","click .action-success":"alertSuccess","click .action-warn":"alertWarn","change #toggle-activation":"toggleActivation"},initialize:function(){var e=this;t.session.on("change:logged_in",this.render,this),require(["jasmine-boot"],function(){e.render()})},render:function(){return $(window).keydown(function(t){123==t.keyCode}),this.$el.html(this.template({activation:t.utils.stash.getItem("bypass-activation")})),this.$el.find(".app-version").html(t.version),this.$el.find(".app-root").html(t.url.base_url),this.$el.find(".backbone-version").html(Backbone.VERSION),this.renderAPI(),this.renderUser(),$("body").append(this.$el),this},renderAPI:function(){this.$el.find(".api-root").html(t.API()),this.checkAPI()},renderUser:function(){var e=t.session.user;this.$el.find(".user-role").html(e.get("role")),this.$el.find(".user-name").html(e.get("full_name"));try{this.$el.find(".user-email").html((e.get("email")||"-Not Set-")+" ("+(e.get("status.email")?"verfied":"unverified")+")")}catch(t){}try{this.$el.find(".user-phone").html((e.get("phone_pretty")||"-Not Set-")+" ("+(e.get("status.phone")?"verfied":"unverified")+")")}catch(t){}try{this.$el.find(".user-dwolla").html(e.get("status.dwolla"))}catch(t){}this.$el.find(".atoken").html(e.get("session.authorization_token")),this.$el.find(".user-company").html(e.get("company.name")||e.get("company"))},toggleActivation:function(e){var n=$(e.currentTarget).is(":checked");n?t.utils.stash.setItem("bypass-activation",!0):t.utils.stash.removeItem("bypass-activation")},toggleAPI:function(){var e=["https://api.plutus.dev/","https://postman.plutus.dev/","http://10.1.10.38:81/","https://10.1.10.38:443/","https://api.staging.payment.rafiproperties.com/","http://api.payment.rafiproperties.com/"],n=t.utils.stash.getItem("API")||t.API(),o=e.indexOf(n);o>=e.length-1&&(o=-1);var i=e[o+1];t.utils.stash.setItem("API",i),this.renderAPI()},checkAPI:function(){var e=this;t.utils.request({method:"GET"}).then(function(){e.$el.find(".status-icon").addClass("success").removeClass("error")}).fail(function(t){console.warn(t),e.$el.find(".status-icon").removeClass("success").addClass("error")})},switchAPI:function(){var e=this;t.router.checkAuth().then(function(){t.controls.logout()}).always(function(){e.toggleAPI()})},toggleMenu:function(){this.$el.toggleClass("active")},consoleApp:function(){console.log(t)},consoleSession:function(){console.log(t.session)},consoleStash:function(){console.log(t.utils.stash)},consoleRequire:function(){console.log(require.s.contexts._.defined)},consoleUser:function(){console.log(t.session.user.attributes)},globalApp:function(){window.app=t,console.log(window.app)},clearStash:function(){t.utils.stash.clear(),console.log("app stash cleared")},viewStash:function(){console.log(t.utils.stash)},sendError:function(t){throw new TypeError("This is a test error")},alertError:function(){t.alerts.error("This is a test error!")},alertSuccess:function(){t.alerts.success("This is a test success messsage!")},alertWarn:function(){t.alerts.warn("This is a test warning!")},showUnitTests:function(){console.log("run unit tests"),console.log($(".jasmine_html-reporter")),$(".jasmine_html-reporter").addClass("visible")},skipIAV:function(){console.log(t.views.activateView);var e,n=t.views.activateView,o={id:"ee36bb47-0960-4c5e-85a8-a933e33e941b",status:"unverified"};e=t.session.get("logged_in")?"account/funding_sources":n.user.get("role")+"s/activate/funding_sources",t.utils.request({path:e,method:"POST",data:o}).then(function(t){n.user.set(t),n.next()})},unitTests:function(){if(this.unit_tests)return void this.showUnitTests();this.unit_tests=!0,describe("app.schema.process",function(){it("should convert formatted phone numbers",function(){var e={first_name:"John",last_name:"Doe",phone:"(617) 555-5555"},n=t.schema.process(e,t.session.user),o={first_name:"John",last_name:"Doe",phone:"6175555555"};expect(n).toEqual(o)}),it("should handle nested schemas",function(){var n={phone:"(617) 555-5432",manager:{phone:"(617) 555-1234",test:{date:moment("4/20/1960"),phone:"(617) 555-4433",more:{phone:"(617) 555-5432",date:moment("5/30/1999"),amount:"2400.50"}}}},o=t.schema.process(n,new e),i={phone:"6175555432",manager:{phone:"6175551234",test:{date:"1960-04-20T04:00:00.000Z",phone:"6175554433",more:{phone:"6175555432",date:"1999-05-30T04:00:00.000Z",amount:2400.5}}}};expect(o).toEqual(i)})}),describe("app.schema.format.money",function(){it("should convert an integer to valid currency string",function(){var e=250,n=t.schema.format.money(e);expect(n).toEqual(250)}),it("should convert a currency string without decimals to valid currency string",function(){var e="250",n=t.schema.format.money(e);expect(n).toEqual(250)}),it("should convert a currency string with dollar sign to valid currency string",function(){var e="$250",n=t.schema.format.money(e);expect(n).toEqual(250)}),it("should throw an error for invalid input",function(){var e="349jd";expect(function(){t.schema.format.money(e)}).toThrow(new TypeError("Invalid currency amount"))}),it("should throw an error for invalid input",function(){var e="$39.23>";expect(function(){t.schema.format.money(e)}).toThrow(new TypeError("Invalid currency amount"))}),it("should throw an error for invalid input",function(){var e="(*&)*&^%";expect(function(){t.schema.format.money(e)}).toThrow(new TypeError("Invalid currency amount"))})}),describe("app.schema.format.phone",function(){it("should convert a pretty phone number to uglified phone number",function(){var e="(203) 555-1234",n=t.schema.format.phone(e);expect(n).toEqual("2035551234")})}),describe("app.schema.format.ISO",function(){it("should convert a date string to ISOString",function(){var e="4/20/2012",n=t.schema.format.ISO(e);expect(n).toEqual("2012-04-20T04:00:00.000Z")}),it("should convert a moment object to ISOString",function(){var e=moment("4/20/2012"),n=t.schema.format.ISO(e);expect(n).toEqual("2012-04-20T04:00:00.000Z")}),it("should throw an error for invalid input",function(){var e="20398234.234/234/234234";expect(function(){t.schema.format.ISO(e)}).toThrow(new TypeError("Invalid ISO date input"))})}),describe("app.utils.stash",function(){it("should save and retrieve a string to app stash",function(){t.utils.stash.setItem("test","ok");var e=t.utils.stash.getItem("test");"ok"===e&&t.utils.stash.removeItem("test"),expect(e).toMatch("ok")})}),describe("app.utils.parseMoney",function(){it("should properly handle too many decimal places",function(){var e=t.utils.parseMoney("123.333");expect(e).toMatch("123.33")}),it("should properly handle not enough decimals",function(){var e=t.utils.parseMoney("123.3");expect(e).toMatch("123.30")}),it("should properly handle no decimals",function(){var e=t.utils.parseMoney("123");expect(e).toMatch("123.00")})}),describe("app.utils.parseName",function(){it("should correctly split up a name with multiple parts",function(){var e=t.utils.parseName("Ben Stein Goldfish"),n={first_name:"Ben Stein",last_name:"Goldfish"};expect(e).toEqual(n)}),it("should correctly split up a name with multiple parts",function(){var e=t.utils.parseName("Ben"),n={first_name:"Ben"};expect(e).toEqual(n)})}),describe("app.utils.validateContact",function(){it('should return "email" for testemail@gmail.com',function(){var e=t.utils.validateContact("testemail@gmail.com");expect(e).toMatch("email")}),it('should return "email" for test@gmail.com',function(){var e=t.utils.validateContact("test@gmail.com");expect(e).toMatch("email")}),it('should return "email" for tes@gmail.com',function(){var e=t.utils.validateContact("tes@gmail.com");expect(e).toBe(!1)}),it('should return "phone" for (203) 555-1234',function(){var e=t.utils.validateContact("(203) 555-1234");expect(e).toMatch("phone")}),it('should return "phone" for 2035551234',function(){var e=t.utils.validateContact("2035551234");expect(e).toMatch("phone")}),it("should return false for (203) 555-1234-65",function(){var e=t.utils.validateContact("(203) 555-1234-65");expect(e).toBe(!1)}),it('should return false for "thisisinvalid"',function(){var e=t.utils.validateContact("thisisinvalid");expect(e).toBe(!1)}),it("should return a phone object when second arg is true",function(){var e=t.utils.validateContact("(203) 555-1234",!0),n={phone:"2035551234"};expect(e).toEqual(n)})}),describe("app.utils.trim",function(){it("should remove empty or null properties in an object",function(){var e={first_name:"Tester",last_name:"Jones",test:"",test2:null,test3:void 0},n=t.utils.trim(e),o={first_name:"Tester",last_name:"Jones"};expect(n).toEqual(o)}),it("should remove empty or null properties in a nested object",function(){var e={first_name:"Tester",last_name:"Jones",test:"",test2:null,test3:void 0,more:{stuff:!0,rules:3,but:"",you:null,dont:void 0}},n=t.utils.trim(e),o={first_name:"Tester",last_name:"Jones",more:{stuff:!0,rules:3}};expect(n).toEqual(o)})}),describe("app.utils.prettyMoney",function(){it("should return prettified positive currency",function(){var e=t.utils.prettyMoney("20.00");expect(e).toEqual("$20.00")}),it("should return prettified negative currency",function(){var e=t.utils.prettyMoney("-20.00");expect(e).toEqual("-$20.00")})}),describe("app.utils.prettyPhone",function(){it("should return prettified phone number",function(){var e=t.utils.prettyPhone("6175551234");expect(e).toEqual("(617) 555-1234")}),it("should return undefined for invalid phone",function(){var e=t.utils.prettyPhone("617555123467");expect(e).toBeFalsy()})}),describe("app.utils.uglyPhone",function(){it("should return uglified phone number",function(){var e=t.utils.uglyPhone("(617) 555-1234");expect(e).toEqual("6175551234")}),it("should return false for invalid phone number",function(){var e=t.utils.uglyPhone("(617) 555-1234234234");expect(e).toBeFalsy()})}),describe("app.utils.findVal",function(){it('should return the key of the property which contains desired value at key "h"',function(){var e={a:{j:2,h:2},b:{j:2,h:3},c:{j:2,h:4}},n=t.utils.findVal(3,e);expect(n).toEqual("b")})}),describe("Array.contains",function(){it("should return true for 1 in [1,2,3,4,5]",function(){var t=[1,2,3,4.5].contains(1);expect(t).toBe(!0)}),it("should return false for 9 in [1,2,3,4,5]",function(){var t=[1,2,3,4.5].contains(9);expect(t).toBe(!1)}),it("should return true for 1,2 in [1,2,3,4,5]",function(){var t=[1,2,3,4.5].contains(1,2);expect(t).toBe(!0)}),it("should return false for 1, 9 in [1,2,3,4,5]",function(){var t=[1,2,3,4.5].contains(1,9);expect(t).toBe(!1)}),it('should return true for "test" in [1,"test", 3, "more"]',function(){var t=[1,"test",3,"more"].contains(1);expect(t).toBe(!0)})}),describe("String.contains",function(){it('should return true for "a" in "apple"',function(){var t="apple".contains("a");expect(t).toBe(!0)}),it('should return false for "a" in "zoology"',function(){var t="zoology".contains("a");expect(t).toBe(!1)}),it('should return true for "a", "p" in "apple',function(){var t="apple".contains("a","p");expect(t).toBe(!0)}),it('should return false for "a", "p" in "zoology',function(){var t="zoology".contains("a","p");expect(t).toBe(!1)}),it('should return true for "test" in "this is a test string"',function(){var t="this is a test string".contains("test");expect(t).toBe(!0)})}),describe("String.insert",function(){it('should return "apple" for "l", 3 in "appe" ',function(){var t="appe".insert("l",3);expect(t).toMatch("apple")}),it("should append arg to the end of string if no second arg is passed",function(){var t="this is a ".insert("test");expect(t).toMatch("this is a test")}),it("should prepend to string if index < 0 is passed",function(){var t=" is a test".insert("this",-1);expect(t).toMatch("this is a test")})}),window.onload();var n=this;setTimeout(function(){n.showUnitTests()},300)}})});
//# sourceMappingURL=DebugView.js.map
