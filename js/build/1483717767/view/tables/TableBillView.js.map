{"version":3,"sources":["view/tables/TableBillView.js"],"names":["define","app","TableRowTemplate","Backbone","View","extend","_","Events","className","events","click","click .action-remove","template","initialize","_options","this","on","deleteModel","model","render","data","toJSON","$el","attr","get","addClass","html","bill","viewModel","$","hasClass","removeClass","route","router","getRoute","model_id","id","views","currentView","selected","navigate","trigger","$row","parentView","queue","push","setTimeout","remove","dialogueConfirm","target","message","controls","modalConfirm"],"mappings":"AAIAA,QACE,MACA,6CAEF,SAASC,EAAKC,GAEZ,MAAOC,UAASC,KAAKC,OAAOC,EAAED,UAAWF,SAASI,QAEhDC,UAAW,MAEXC,QACEC,MAAS,YACTC,uBAAwB,mBAG1BC,SAAUN,EAAEM,SAASV,GAErBW,WAAY,SAASC,GACfA,GAAUR,EAAED,OAAOU,KAAMD,GAC7BC,KAAKC,GAAG,gBAAiBD,KAAKE,YAAaF,MAC3CA,KAAKG,MAAMF,GAAG,SAAUD,KAAKI,OAAQJ,MACrCA,KAAKI,UAGPA,OAAQ,WACN,GAAIC,GAAOL,KAAKG,MAAMG,QAKtB,OAJAN,MAAKO,IAAIC,KAAK,UAAWR,KAAKG,MAAMM,IAAI,QACT,YAA3BT,KAAKG,MAAMM,IAAI,SAAuBT,KAAKO,IAAIG,SAAS,WAE5DV,KAAKO,IAAII,KAAKX,KAAKH,UAAWe,KAAMP,KAC7BL,MAGTa,UAAW,WACT,IAAKC,EAAE,UAAUC,SAAS,WAAY,CACpCD,EAAE,eAAeE,YAAY,YAC7BhB,KAAKO,IAAIG,SAAS,WAElB,IAAIO,GAAQ/B,EAAIgC,OAAOC,WACnBC,EAAWpB,KAAKG,MAAMkB,EAE1BnC,GAAIoC,MAAMC,YAAYC,SAAWJ,EAEjClC,EAAIgC,OAAOO,SAASR,EAAQ,IAAMG,GAAYM,SAAS,MAI3DxB,YAAa,WACX,GACIyB,GAAO3B,KAAKO,GAEhBP,MAAK4B,WAAWF,QAAQ,gBACxB1B,KAAK4B,WAAWC,MAAMC,KAAK9B,KAAKG,OAEhCwB,EAAKjB,SAAS,cACdqB,WAAW,WACTJ,EAAKjB,SAAS,cACdqB,WAAW,WACTJ,EAAKK,UACJ,MACF,MAGLC,gBAAiB,WACf,GAAIC,GAASlC,KAAKG,MAAMM,IAAI,aACxB0B,EAAU,mCAAqCD,EAAS,GAE5DhD,GAAIkD,SAASC,aAAaF,EAAS,gBAAiBnC","file":"TableBillView.js","sourcesContent":["/**\n * TableBillView.js\n */\n\ndefine([\n  'app',\n  'text!templates/tables/table-row-bill.html'\n],\nfunction(app, TableRowTemplate) {\n\n  return Backbone.View.extend(_.extend({}, Backbone.Events, {\n\n    className: 'row',\n\n    events: {\n      'click': 'viewModel',\n      'click .action-remove': 'dialogueConfirm'\n    },\n\n    template: _.template(TableRowTemplate),\n\n    initialize: function(_options) {\n      if (_options) _.extend(this, _options);\n      this.on('confirmDelete', this.deleteModel, this);\n      this.model.on('change', this.render, this);\n      this.render();\n    },\n\n    render: function() {\n      var data = this.model.toJSON();\n      this.$el.attr('data-id', this.model.get('_id'));\n      if (this.model.get('type') === 'monthly') this.$el.addClass('success');\n\n      this.$el.html(this.template({ bill: data }));\n      return this;\n    },\n\n    viewModel: function() {\n      if (!$('.table').hasClass('editing')) {\n        $('.table .row').removeClass('selected');\n        this.$el.addClass('selected');\n\n        var route = app.router.getRoute();\n        var model_id = this.model.id;\n\n        app.views.currentView.selected = model_id;\n        \n        app.router.navigate(route + '/' + model_id, { trigger: true });\n      }\n    },\n\n    deleteModel: function() {\n      var self = this;\n      var $row = this.$el;\n\n      this.parentView.trigger('modelDeleted');\n      this.parentView.queue.push(this.model);\n\n      $row.addClass('removing-1');\n      setTimeout(function() {\n        $row.addClass('removing-2');\n        setTimeout(function() {\n          $row.remove();\n        }, 800);\n      }, 100);\n    },\n\n    dialogueConfirm: function() {\n      var target = this.model.get('full_name');\n      var message = 'Are you sure you want to delete ' + target + '?';\n\n      app.controls.modalConfirm(message, 'confirmDelete', this);\n    }\n  }));\n});"]}