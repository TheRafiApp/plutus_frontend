define(["app","model/users/TenantModel","model/leases/MyLeaseModel","view/cards/user_payments","view/modals/ModalSplitView","text!templates/leases/mylease.html"],function(e,t,i,n,s,a){return Backbone.View.extend(_.extend({},Backbone.Events,{className:"panel lease-view",events:{"click .action-edit-split":"showSplitModal"},template:_.template(a),initialize:function(t){t&&_.extend(this,t);var n=this;this.model=new i({_id:e.router.getPage()}),this.model.fetch().then(function(){n.render()}).fail(function(e){console.warn(e)})},attachEvents:function(){this.on("editSplit",this.initialize,this),this.listening=!0},render:function(){this.listening||this.attachEvents();var i=this;this.$el.html(this.template({lease:this.model.toJSON(),prettyMoney:e.utils.prettyMoney}));var s=$.extend(!0,[],this.model.get("tenants")),a=e.session.user.id;s=s.sort(function(e,t){return e._id===a?-1:t._id===a?1:void 0}),console.log(s);var l=this.model.get("split");return _.each(s,function(e){var s=new t(e),a=new n({data:s.toJSON(),amount:l[e._id]});i.$el.find(".split-cards").append(a.$el)}),$(".tertiary").removeClass("loading"),this},showSplitModal:function(){this.modal=new s({action:"edit",eventName:"editSplit",context:this})}}))});
//# sourceMappingURL=MyleaseView.js.map
