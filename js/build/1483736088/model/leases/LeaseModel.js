define(["app"],function(t){var e=t.Model.extend({name:"lease",displayName:"lease",initialize:function(t,e){e||(e={}),this.options||(this.options={}),_.extend(this.options,e),this.options.action||(this.options.action="")},urlRoot:function(){return t.API()+"leases/"+this.options.action},schema:{rent:{type:"money"},tenants:{type:"array"},start_date:{type:"ISO"},end_date:{type:"ISO"},charges:{scheduled:[{amount:{type:"charge"},date:{type:"ISO"}}],recurring:[{amount:{type:"charge"}}]},first_month:{type:"money"},last_month:{type:"money"},security:{type:"money"},split:{type:"money_or_zero"}},filters:["lease","term","address","address_short","length","number_pretty","start_moment","end_moment","first_month","last_month"],start_moment:Backbone.computed("start_date",function(){var t=this.get("start_date");if(t)return moment.utc(t)}),end_moment:Backbone.computed("end_date",function(){var t=this.get("end_date");if(t)return moment.utc(t)}),number_pretty:Backbone.computed("unit",function(){var t=this.get("unit.number");if(t)return/^[\d]/.test(t)&&(t="#"+t),t}),address_short:Backbone.computed("property","number_pretty",function(){var t=this.get("property"),e=this.get("number_pretty");if(t&&e)return t.address+" "+e}),address:Backbone.computed("property","number_pretty",function(){var e=this.get("property"),n=this.get("number_pretty");if(e&&n&&"string"!=typeof e)return e.address+" "+n+", "+e.city+" "+t.utils.stateAbbr(e.state)}),term:Backbone.computed("start_moment","end_moment",function(){var t=this.get("start_moment");if(t){t=t.format("MM/DD/YY");var e=this.get("end_moment")?this.get("end_moment").format("MM/DD/YY"):"N/A";if(t)return t+" â€“ "+e}}),lease:Backbone.computed("term","address",function(){var t=this.get("address"),e=this.get("term");if(e&&t)return t+", "+e}),length:Backbone.computed("start_date","end_date",function(){if(this.isNew())return"";var t=this.get("start_moment"),e=this.get("end_moment");if(t){if(!e)return"N/A";var n=moment.duration(e.diff(t)),r=parseFloat((Math.round(2*n.asMonths())/2).toFixed(1)),a=n.asDays(),s=r>1?r+" Months":a+" Days";return{months:r,days:a,auto:s}}}),first_month:Backbone.computed("charges",function(){var t=this.get("charges.scheduled");if(t)return t=t.filter(function(t){return"first_month"==t.type}),1===t.length&&t[0]}),last_month:Backbone.computed("charges",function(){var t=this.get("charges.scheduled");if(t)return t=t.filter(function(t){return"last_month"==t.type}),1===t.length&&t[0]}),active:Backbone.computed("start_moment","end_moment",function(){var t=this.get("start_moment");if(t){var e=moment.utc();return this.containsDate(e)}}),containsDate:function(t){var e=moment.utc(t),n=this.get("start_moment"),r=this.get("end_moment");return!r&&n<e||n<=e&&e<=r},validation:{unit:{required:!0},start_date:{required:!0},tenants:{required:!0},rent:t.utils.validateMoney,"charges.scheduled":t.utils.validateCharges,"charges.recurring":t.utils.validateCharges}});return e});
//# sourceMappingURL=LeaseModel.js.map
