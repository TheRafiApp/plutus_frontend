define(["app","model/companies/CompanyModel","text!templates/companies/company.html","text!templates/headers/header-tertiary-model.html"],function(e,t,i,o){return Backbone.View.extend(_.extend({},Backbone.Events,{className:"company-view",events:{"click .action-edit":"toggleEdit","click .action-cancel":"toggleEdit","click .action-save":"promptSave","click .action-delete":"promptDelete","click .action-close":"hideTertiary"},options:{edit:!0,delete:!0},initialize:function(e){_.extend(this,e);var n=this;this.template=_.template(i),this.template_container=_.template(o),this.model=new t({_id:this._id}),this.model.fetch().then(function(){n.render()}),this.on("confirmSave",this.saveModel,this),this.on("confirmDelete",this.deleteModel,this)},render:function(){var t=this.model.toJSON(),i={model:this.model.get("name")};return this.$el.html(this.template_container({header:i,options:this.options})),this.$el.find(".scroll-y").html(this.template({company:t})),console.log($(".tertiary")),$('.row[data-id="'+e.views.currentView.selected+'"]').addClass("selected"),$(".tertiary").removeClass("loading"),this},toggleEdit:function(){var e=this.$el.find(".action-edit"),t=e.parent().parent(),i=this.$el.find("form.form-model");i.hasClass("editing")?(t.removeClass("editing"),i.removeClass("editing"),i.find("input").prop("disabled",!0)):(t.addClass("editing"),i.addClass("editing"),i.find("input").prop("disabled",!1))},promptSave:function(){var t=this.model.get("name"),i="You have made changes to "+t+". Are you sure you want to save your changes?";e.controls.modalConfirm(i,"confirmSave",this)},promptDelete:function(){var t=this.model.get("name"),i="Are you sure you want to delete "+t+"?";e.controls.modalConfirm(i,"confirmDelete",this)},saveModel:function(){var t=$(".form-model"),i=t.serializeArray(),o={};$.map(i,function(e){o[e.name]=e.value}),this.model.save(o).then(function(){e.router.navigate("companies",{trigger:!0})}).fail(function(t){e.router.navigate("companies",{trigger:!0}),e.alerts.success("No changes were made.")})},deleteModel:function(t,i){var o=this,n=$.Deferred();return this.model.destroy().then(function(){var t=e.router.getRoute();return e.router.navigate(t,{trigger:!0}),n.resolve()}).fail(function(t){return i||e.controls.handleError(t,null,o,"deleteModel"),n.reject(t)}),n},hideTertiary:function(){e.views.modelView&&e.controls.hideTertiary()}}))});
//# sourceMappingURL=CompanyView.js.map
