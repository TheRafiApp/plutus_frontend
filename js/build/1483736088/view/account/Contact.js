define(["app","view/modals/ModalContactView","text!templates/account/account-contact.html"],function(e,t,o){return Backbone.View.extend(_.extend({},Backbone.Events,{className:"account account-payment",events:{"click .action-change-phone":"changePhone","click .action-change-email":"changeEmail","click .action-remove-phone":"promptRemovePhone","click .action-remove-email":"promptRemoveEmail","click .action-verify-phone":"verifyPhone","click .action-verify-email":"verifyEmail"},template:_.template(o),initialize:function(e){e&&_.extend(this,e);var t=this;this.model=this.parentModel,this.refresh?this.model.fetch().then(function(){t.render()}):this.render()},render:function(){this.on("confirmRemovePhone",this.removePhone,this),this.on("confirmRemoveEmail",this.removeEmail,this);var e=this.model.toJSON();return this.$el.html(this.template({user:e})),this.delegateEvents(),e.phone_pretty&&this.$el.find(".phone-data").mask("(000) 000-0000"),this},changePhone:function(){var e="add";(this.model.get("phone")||this.model.get("authentication.phone"))&&(e="edit"),this.modal=new t({action:e,method:"phone",context:this})},changeEmail:function(){var e="add";(this.model.get("email")||this.model.get("authentication.email"))&&(e="edit"),this.modal=new t({action:e,method:"email",context:this})},verifyPhone:function(){this.modal=new t({action:"verify",method:"phone",context:this})},verifyEmail:function(){this.modal=new t({action:"verify",method:"email",context:this})},promptRemovePhone:function(){if(!this.model.get("email"))return void e.alerts.error("You must have at least one contact method.");var t=this.model.get("phone_pretty"),o="Are you sure you want to remove your phone number: "+t+"?";e.controls.modalConfirm(o,"confirmRemovePhone",this)},promptRemoveEmail:function(){if(!this.model.get("phone"))return void e.alerts.error("You must have at least one contact method.");var t=this.model.get("email"),o="Are you sure you want to remove your email address: "+t+"?";e.controls.modalConfirm(o,"confirmRemoveEmail",this)},removePhone:function(){this.model.options.action="phone",this.model.destroy().then(function(){e.views.currentView.initialize()}).fail(function(){e.alerts.error("Unable to delete your phone number")})},removeEmail:function(){this.model.options.action="email",this.model.destroy().then(function(){e.views.currentView.initialize()}).fail(function(){e.alerts.error("Unable to delete your email address")})}}))});
//# sourceMappingURL=Contact.js.map
