define(["app","model/leases/LeaseModel","text!templates/cards/lease.html"],function(e,t,n){return Backbone.View.extend(_.extend({},Backbone.Events,{className:"lease grid__col grid__col--1-of-1",events:{click:"viewLease","click .action-edit-lease":"editLease","click .action-renew-lease":"renewLease","click .action-delete-lease":"promptDelete"},template:_.template(n),initialize:function(e){_.extend(this,e),this.model=new t(this.data),this.render()},render:function(){this.on("confirmDelete",this.deleteModel,this);var t="past",n=this.model.get("start_moment"),i=this.model.get("end_moment"),a=moment.utc();return n<a&&a<i?t="active":n>a&&(t="future"),this.$el.html(this.template({lease:this.model.toJSON(),state:t,tenants:this.tenants,prettyMoney:e.utils.prettyMoney})),this},editLease:function(e){e.preventDefault(),e.stopPropagation(),this.parentView.editLease(this)},renewLease:function(e){e.preventDefault(),e.stopPropagation(),this.parentView.renewLease(this)},promptDelete:function(){var t,n=moment.utc(this.model.get("start_date")).format("MM/DD/YYYY"),i=this.model.get("end_date");i&&(t=moment.utc().format("MM/DD/YYYY"));var a=n+" – "+(t||"∞"),s="Are you sure you want to delete "+a+"?";e.controls.modalConfirm(s,"confirmDelete",this)},deleteModel:function(t,n){var i=this,a=$.Deferred();return this.model.destroy().then(function(){return i.parentView.initialize(),a.resolve()}).fail(function(t){return n||e.controls.handleError(t,null,i,"deleteModel"),a.reject(t)}),a},viewLease:function(t){if(!$(t.target).hasClass("action-delete-lease")){var n=this.model.get("_id");e.router.navigate("leases/"+n,{trigger:!0})}}}))});
//# sourceMappingURL=lease.js.map
