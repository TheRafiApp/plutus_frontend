define(["app","view/modals/ModalPasswordView","view/modals/ModalConfirmView","text!templates/account/account-profile.html"],function(e,t,i,n){return Backbone.View.extend(_.extend({},Backbone.Events,{className:"account account-general",events:{"click .action-edit":"toggleEdit","click .action-cancel":"cancelEdit","click .action-save":"promptSave","click .action-delete":"promptDelete","click .action-change-pw":"promptPassword"},template:_.template(n),initialize:function(e){e&&_.extend(this,e);var t=this;this.model=this.parentModel,Backbone.Validation.bind(this),this.on("changePassword",this.changePassword,this),this.on("confirmSave",this.saveUser,this),this.on("confirmDelete",this.deleteUser,this),this.model.fetch().then(function(){t.render()})},render:function(){var e=this.model.toJSON();return this.$el.html(this.template({user:e})),this.delegateEvents(),this},toggleEdit:function(){var e=this.$el.find(".action-edit"),t=e.parent().parent(),i=this.$el.find("form.form-model");i.hasClass("editing")?(t.removeClass("editing"),i.removeClass("editing"),i.find("input").prop("disabled",!0)):(t.addClass("editing"),i.addClass("editing"),i.find("input").prop("disabled",!1))},cancelEdit:function(){this.render()},promptSave:function(){if(console.log("promptSave"),console.log(e.utils.validate(this)),!e.utils.validate(this))return!1;var t=(this.model.get("full_name"),"You have made changes to your profile. Are you sure you want to save your changes?");e.controls.modalConfirm(t,"confirmSave",this)},promptDelete:function(){var t=this.model.get("first_name"),i=t+", are you sure you want to delete your account?";e.controls.modalHardConfirm(i,"accountDeleted",this)},saveUser:function(){if(!e.utils.validate(this))return!1;var t=this,i=$(".form-model"),n=i.serializeArray(),o={};$.map(n,function(e){o[e.name]=e.value}),this.model.save(o).then(function(){t.render()},function(){t.render(),e.alerts.success("No changes were made.")})},deleteUser:function(){this.model.destroy({success:function(){e.router.navigate("users",{trigger:!0,replace:!0})},error:function(){console.warn(arguments)}})},promptPassword:function(){this.modal=new t({eventName:"changePassword",context:this})},changePassword:function(){e.views.currentView.initialize()}}))});
//# sourceMappingURL=Profile.js.map
